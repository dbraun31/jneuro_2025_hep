library(tidyverse)
library(here)
library(fs)
setwd(path(here(), 'analysis/scripts/preprocessing/cfa_control'))
hr <- read.csv('heartrate.csv')
head(hr)
nrow(hr)
amp <- read.csv('ecga.csv')
head(amp)
amp[1:20,]
head(hr)
hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
head()
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
t.test(hrs$activated, hrs$deactivated, paired=TRUE)
library(BayesFactor)
bf_extract(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))
extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))
extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
#hr_summary <- hrs %>%
hrs %>%
gather(arou, hr, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(hr), se = sd(hr) / sqrt(N))
hr <- read.csv('heartrate.csv')
head(hr)
head(amp)
amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
head()
amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
head()
amps <- amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
spread(arou, peak_)
t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_ho <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
bf_ho
bf_h0 <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
N <- length(unique(amp$subject))
N
N <- length(unique(hr$subject))
N
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
amp_t <- t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
bf_h0_amp <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
hr_summary <- hrs %>%
gather(arou, hr, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(hr), se = sd(hr) / sqrt(N))
# ECG amplitude
amps <- amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
spread(arou, peak_)
amp_t <- t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_h0_amp <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
N <- length(unique(amp$subject))
amp_summary <- amps %>%
gather(arou, amp, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(amp), se = sd(amp) / sqrt(N))
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hr_t
print('BF null')
bf_h0_amp
print('--------------')
print('ECG AMPLITUDE')
amp_summary
amp_t
print('BF null')
bf_h0_amp
sink(NULL)
hr <- read.csv('heartrate.csv')
amp <- read.csv('ecga.csv')
length(unique(amp$subject))
head(amp)
amp <- read.csv('ecga.csv')
amp
amp <- read.csv('ecga.csv')
amp
sink(NULL)
amp
length(unique(amp$subject))
library(tidyverse)
library(here)
library(fs)
library(BayesFactor)
setwd(path(here(), 'analysis/scripts/preprocessing/cfa_control'))
hr <- read.csv('heartrate.csv')
amp <- read.csv('ecga.csv')
# Heart rate
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
hr_summary <- hrs %>%
gather(arou, hr, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(hr), se = sd(hr) / sqrt(N))
# ECG amplitude
amps <- amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
spread(arou, peak_)
amp_t <- t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_h0_amp <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
N <- length(unique(amp$subject))
amp_summary <- amps %>%
gather(arou, amp, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(amp), se = sd(amp) / sqrt(N))
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hr_t
print('BF null')
bf_h0_amp
print('--------------')
print('ECG AMPLITUDE')
amp_summary
amp_t
print('BF null')
bf_h0_amp
sink(NULL)
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hr_t
print('BF null')
bf_h0_hr
print('--------------')
print('ECG AMPLITUDE')
amp_summary
amp_t
print('BF null')
bf_h0_amp
sink(NULL)
q()
library(tidyverse)
library(here)
library(fs)
library(BayesFactor)
setwd(path(here(), 'analysis/scripts/preprocessing/cfa_control'))
hr <- read.csv('heartrate.csv')
amp <- read.csv('ecga.csv')
# Heart rate
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
N
head(hr)
10 %in% hr$subject
14 %in% hr$subject
13 %in% hr$subject
d <- read.csv('../../../data/MW_EEG_behavioral.csv')
length(unique(d$subject))
13 %in% d$subject
14 %in% d$subject
head(d[d$subject==13,])
d[d$subject==13,]
bads <- c(10, 13, 14)
library(tidyverse)
library(here)
library(fs)
library(BayesFactor)
setwd(path(here(), 'analysis/scripts/preprocessing/cfa_control'))
hr <- read.csv('heartrate.csv')
amp <- read.csv('ecga.csv')
bads <- c(10, 13, 14)
hr <- hr[!hr$subject %in% bads,]
amp <- amp[!amp$subject %in% bads,]
# Heart rate
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
hr_summary <- hrs %>%
gather(arou, hr, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(hr), se = sd(hr) / sqrt(N))
# ECG amplitude
amps <- amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
spread(arou, peak_)
amp_t <- t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_h0_amp <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
N <- length(unique(amp$subject))
amp_summary <- amps %>%
gather(arou, amp, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(amp), se = sd(amp) / sqrt(N))
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hr_t
print('BF null')
bf_h0_hr
print('--------------')
print('ECG AMPLITUDE')
amp_summary
amp_t
print('BF null')
bf_h0_amp
sink(NULL)
head(amps)
nrow(amps)
hr_summary
head
(hrs)
hrs$subject[!hrs$subject %in% amps$subject,]
head(amps$subject)
hrs$subject
hrs$subject %in% amps$subject
!hrs$subject %in% amps$subject
hrs$subject[!hrs$subject %in% amps$subject]
head(amp)
25 %in% amp$subject
25 %in% hrs$subject
length(unique(d$subject))
25 %in% d$subject
10 %in% d$subject
13 %in% d$subject
14 %in% d$subject
m <- readRDS('../../../data/cluster_result.rds')
m$eeg$subject
25 %in% unique(m$eeg$subject)
library(tidyverse)
library(here)
library(fs)
library(BayesFactor)
setwd(path(here(), 'analysis/scripts/preprocessing/cfa_control'))
hr <- read.csv('heartrate.csv')
amp <- read.csv('ecga.csv')
bads <- c(10, 13, 14)
hr <- hr[!hr$subject %in% bads,]
amp <- amp[!amp$subject %in% bads,]
length(unique(amp$subject))
length(unique(hr$subject))
# Heart rate
hrs <- hr %>%
group_by(subject, arou) %>%
summarize(hr = mean(heartrate)) %>%
spread(arou, hr)
hr_t <- t.test(hrs$activated, hrs$deactivated, paired=TRUE)
bf_h0_hr <- 1 / extractBF(ttestBF(hrs$activated, hrs$deactivated, paired=TRUE))$bf
N <- length(unique(hr$subject))
hr_summary <- hrs %>%
gather(arou, hr, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(hr), se = sd(hr) / sqrt(N))
# ECG amplitude
amps <- amp %>%
group_by(subject, probe, arou) %>%
summarize(peak = mean(peak_ecg)) %>%
group_by(subject, arou) %>%
summarize(peak_ = mean(peak)) %>%
spread(arou, peak_)
amp_t <- t.test(amps$activated, amps$deactivated, paired=TRUE)
bf_h0_amp <- 1/extractBF(ttestBF(amps$activated, amps$deactivated, paired=TRUE))$bf
N <- length(unique(amp$subject))
amp_summary <- amps %>%
gather(arou, amp, activated:deactivated) %>%
group_by(arou) %>%
summarize(m = mean(amp), se = sd(amp) / sqrt(N))
sink(file='summary.txt')
print('HEART RATE')
hr_summary
hr_t
print('BF null')
bf_h0_hr
print('--------------')
print('ECG AMPLITUDE')
amp_summary
amp_t
print('BF null')
bf_h0_amp
sink(NULL)
q()
