library(tidyverse)
library(arrow)
library(lme4)
d <- read.csv('alpha_contrast.csv')
d <- d %>%
gather(arousal, power, low, high) %>%
mutate(power_log = log(power))
d %>%
group_by(arousal) %>%
summarize(power = mean(power_log), se = sd(power_log) / sqrt(n()), N=n())
head(d)
t.test(d[d$arousal=='low',]$power_log, d[d$arousal=='high',]$power_log, paired=TRUE)
q()
q()
remove.packages('lme4')
q()\
q()
install.packages('lme4')
library(tidyverse)
library(lme4)
# Parameters
n_subjects <- 30         # Number of subjects
n_obs <- 10              # Observations per subject per level of IV
iv_levels <- c("A", "B") # Levels of the categorical IV
fixed_effect <- 2        # Fixed effect difference between levels of IV
# Generate data
data <- expand.grid(
subject = factor(1:n_subjects),
IV = iv_levels,
obs = 1:n_obs
) %>%
mutate(
# Random intercepts and slopes by subject
intercept_subject = rnorm(n_subjects, mean = 0, sd = 1)[subject],
slope_subject = rnorm(n_subjects, mean = 0, sd = 0.5)[subject],
# Generate DV based on fixed effect of IV and random effects
DV = intercept_subject +
slope_subject * (IV == "B") +     # Random slope only applies for "B"
ifelse(IV == "B", fixed_effect, 0) + # Fixed effect only applies for "B"
rnorm(n(), mean = 0, sd = 1)      # Residual noise
)
m2 <- lmer(DV ~ IV + (1 + IV | subject), data=data)
summary(m2)
d <- read.csv('alpha-parieto_contrast.csv')
d <- d %>%
gather(arousal, power, low, high) %>%
mutate(power_log = log(power))
d %>%
group_by(arousal) %>%
summarize(power = mean(power_log), se = sd(power_log) / sqrt(n()), N=n())
t.test(d[d$arousal=='low',]$power_log, d[d$arousal=='high',]$power_log, paired=TRUE)
m1 <- lmerTest::lmer(power_log ~ arousal + (1 | subject), data = d)
install.packages('lmerTest')
m1 <- lmerTest::lmer(power_log ~ arousal + (1 + arousal | subject), data = d)
m1 <- lmerTest::lmer(power_log ~ arousal + (1 | subject), data = d)
summary(m1)
q()
